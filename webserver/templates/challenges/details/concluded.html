{% extends 'base.html' %}
{% from 'datasets/macros.html' import render_job_status %}
{% from 'challenges/macros.html' import challenge_details %}

{% block title %}{{ challenge["name"] }} - Challenges - AcousticBrainz{% endblock %}

{% block content %}
  <h2 class="page-title">{{ challenge["name"] }}</h2>
  <h3 class="page-subtitle">Dataset creation challenge</h3>

  <div class="alert alert-info" role="alert">
    This challenge has started on <strong>{{ challenge['start_time']|datetime }}</strong> and
    {{ 'ended' if past_deadline else 'will end' }} on <strong>{{ challenge['end_time']|datetime }}</strong>.
  </div>

  {{ challenge_details(challenge) }}

  {% if past_deadline %}
    <div class="alert alert-info" role="alert">
      <strong>This challenge hasn't concluded yet.</strong>
      Some of the submitted datasets still need to be evaluated.
      Please, look at the table below for additional information.
    </div>
  {% endif %}

  <h3>Results</h3>
  <table class="table table-striped">
    <thead>
    <tr>
      <th>#</th>
      <th>Submitted by</th>
      <th>Accuracy</th>
      <th>Submission time</th>
      <th>Snapshot ID</th>
      <th>Job ID</th>
    </tr>
    </thead>
    <tbody>
    {% for s in submissions %}
      <tr>
        <td>{{ loop.index }}</td>
        <td>
          <a href="{{ url_for('user.profile', musicbrainz_id=s["eval_job"]["dataset"]["author"]["musicbrainz_id"]) }}">
            {{ s["eval_job"]["dataset"]["author"]["musicbrainz_id"] }}
          </a>
        </td>
        <td><strong>{{ s["eval_job"]["job_result"]["accuracy"] }}</strong></td>
        <td>{{ s["eval_job"]["created"]|datetime }}</td>
        <td>{{ s["eval_job"]["snapshot_id"] }}</td>
        <td>{{ s["eval_job"]["id"] }}</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
{% endblock %}
